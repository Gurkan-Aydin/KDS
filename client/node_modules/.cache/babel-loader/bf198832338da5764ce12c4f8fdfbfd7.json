{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\luminary\\\\Projects\\\\KDS\\\\client\\\\src\\\\contexts\\\\adminContext.js\";\nimport React from \"react\";\nimport { Redirect } from 'react-router-dom';\nconst Context = React.createContext();\nexport class AdminProvider extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      isValid: false,\n      loggedAdmin: [],\n      message: \"\",\n      redirect: false,\n      dispatch: action => {\n        this.setState(this.reducer(action));\n      }\n    };\n\n    this.reducer = action => {\n      switch (action.type) {\n        case \"adminIsValid\":\n          this.changeValid(action.payload);\n          this.setState({\n            message: \"\"\n          });\n          break;\n\n        default:\n          this.setState({\n            message: \"wrong admin acation\"\n          });\n      }\n    };\n\n    this.renderRedirect = () => {\n      if (this.state.redirect) {\n        return /*#__PURE__*/React.createElement(Redirect, {\n          to: \"/target\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 36,\n            columnNumber: 20\n          }\n        });\n      }\n    };\n\n    this.changeValid = async input => {\n      const response = await fetch(`/api/admin/getByUsername/${input.username}`);\n      const admins = await response.json();\n\n      if (admins === []) {\n        this.setState({\n          message: \"wrong username\"\n        });\n      } else {\n        for (let admin of admins) {\n          let inputPassword = input.password;\n          let password = admin.password;\n\n          if (password !== inputPassword) {\n            this.setState({\n              message: \"wrong password\"\n            });\n          } else {\n            this.setState({\n              message: \"\",\n              redirect: true\n            });\n            localStorage.setItem('current', JSON.stringify({\n              loggedAdmin: admin,\n              isValid: true\n            }));\n          }\n        }\n      }\n    };\n  }\n\n  render() {\n    const {\n      state,\n      props: {\n        children\n      }\n    } = this;\n    return /*#__PURE__*/React.createElement(Context.Provider, {\n      value: state,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 16\n      }\n    }, children);\n  }\n\n}\nexport const AdminConsumer = Context.Consumer;","map":{"version":3,"sources":["C:/Users/luminary/Projects/KDS/client/src/contexts/adminContext.js"],"names":["React","Redirect","Context","createContext","AdminProvider","Component","state","isValid","loggedAdmin","message","redirect","dispatch","action","setState","reducer","type","changeValid","payload","renderRedirect","input","response","fetch","username","admins","json","admin","inputPassword","password","localStorage","setItem","JSON","stringify","render","props","children","AdminConsumer","Consumer"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,QAAT,QAAyB,kBAAzB;AAEA,MAAMC,OAAO,GAAGF,KAAK,CAACG,aAAN,EAAhB;AAGA,OAAO,MAAMC,aAAN,SAA4BJ,KAAK,CAACK,SAAlC,CAA4C;AAAA;AAAA;AAAA,SAE/CC,KAF+C,GAEvC;AACJC,MAAAA,OAAO,EAAE,KADL;AAEJC,MAAAA,WAAW,EAAE,EAFT;AAGJC,MAAAA,OAAO,EAAE,EAHL;AAIJC,MAAAA,QAAQ,EAAE,KAJN;AAKJC,MAAAA,QAAQ,EAAGC,MAAD,IAAY;AAClB,aAAKC,QAAL,CAAc,KAAKC,OAAL,CAAaF,MAAb,CAAd;AACH;AAPG,KAFuC;;AAAA,SAY/CE,OAZ+C,GAYpCF,MAAD,IAAY;AAClB,cAAQA,MAAM,CAACG,IAAf;AACI,aAAK,cAAL;AACI,eAAKC,WAAL,CAAiBJ,MAAM,CAACK,OAAxB;AACA,eAAKJ,QAAL,CAAc;AACVJ,YAAAA,OAAO,EAAE;AADC,WAAd;AAGA;;AACJ;AACI,eAAKI,QAAL,CAAc;AACVJ,YAAAA,OAAO,EAAE;AADC,WAAd;AARR;AAYH,KAzB8C;;AAAA,SA2B/CS,cA3B+C,GA2B9B,MAAM;AACnB,UAAI,KAAKZ,KAAL,CAAWI,QAAf,EAAyB;AACrB,4BAAO,oBAAC,QAAD;AAAU,UAAA,EAAE,EAAC,SAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAAP;AACH;AACJ,KA/B8C;;AAAA,SAiC/CM,WAjC+C,GAiCjC,MAAOG,KAAP,IAAiB;AAC3B,YAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAE,4BAA2BF,KAAK,CAACG,QAAS,EAA5C,CAA5B;AACA,YAAMC,MAAM,GAAG,MAAMH,QAAQ,CAACI,IAAT,EAArB;;AACA,UAAID,MAAM,KAAK,EAAf,EAAmB;AACf,aAAKV,QAAL,CAAc;AAAEJ,UAAAA,OAAO,EAAE;AAAX,SAAd;AACH,OAFD,MAEO;AACH,aAAK,IAAIgB,KAAT,IAAkBF,MAAlB,EAA0B;AACtB,cAAIG,aAAa,GAAGP,KAAK,CAACQ,QAA1B;AACA,cAAIA,QAAQ,GAAGF,KAAK,CAACE,QAArB;;AAEA,cAAGA,QAAQ,KAAKD,aAAhB,EAA8B;AAC1B,iBAAKb,QAAL,CAAc;AAAEJ,cAAAA,OAAO,EAAE;AAAX,aAAd;AACH,WAFD,MAEK;AACD,iBAAKI,QAAL,CAAc;AAAEJ,cAAAA,OAAO,EAAE,EAAX;AAAgBC,cAAAA,QAAQ,EAAE;AAA1B,aAAd;AACAkB,YAAAA,YAAY,CAACC,OAAb,CAAqB,SAArB,EAAgCC,IAAI,CAACC,SAAL,CAAe;AAAEvB,cAAAA,WAAW,EAAEiB,KAAf;AAAsBlB,cAAAA,OAAO,EAAE;AAA/B,aAAf,CAAhC;AACH;AACJ;AACJ;AACJ,KAnD8C;AAAA;;AAqD/CyB,EAAAA,MAAM,GAAG;AACL,UAAM;AAAE1B,MAAAA,KAAF;AAAS2B,MAAAA,KAAK,EAAE;AAAEC,QAAAA;AAAF;AAAhB,QAAiC,IAAvC;AACA,wBAAO,oBAAC,OAAD,CAAS,QAAT;AAAkB,MAAA,KAAK,EAAE5B,KAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAiC4B,QAAjC,CAAP;AACH;;AAxD8C;AA2DnD,OAAO,MAAMC,aAAa,GAAGjC,OAAO,CAACkC,QAA9B","sourcesContent":["import React from \"react\";\r\nimport { Redirect } from 'react-router-dom'\r\n\r\nconst Context = React.createContext();\r\n\r\n\r\nexport class AdminProvider extends React.Component {\r\n\r\n    state = {\r\n        isValid: false,\r\n        loggedAdmin: [],\r\n        message: \"\",\r\n        redirect: false,\r\n        dispatch: (action) => {\r\n            this.setState(this.reducer(action));\r\n        }\r\n    };\r\n\r\n    reducer = (action) => {\r\n        switch (action.type) {\r\n            case \"adminIsValid\":\r\n                this.changeValid(action.payload);\r\n                this.setState({\r\n                    message: \"\"\r\n                })\r\n                break;\r\n            default:\r\n                this.setState({\r\n                    message: \"wrong admin acation\"\r\n                })\r\n        }\r\n    };\r\n\r\n    renderRedirect = () => {\r\n        if (this.state.redirect) {\r\n            return <Redirect to='/target' />\r\n        }\r\n    }\r\n\r\n    changeValid = async (input) => {\r\n        const response = await fetch(`/api/admin/getByUsername/${input.username}`)\r\n        const admins = await response.json();\r\n        if (admins === []) {\r\n            this.setState({ message: \"wrong username\" });\r\n        } else {\r\n            for (let admin of admins) {\r\n                let inputPassword = input.password;\r\n                let password = admin.password;\r\n\r\n                if(password !== inputPassword){\r\n                    this.setState({ message: \"wrong password\"});\r\n                }else{\r\n                    this.setState({ message: \"\" , redirect: true});\r\n                    localStorage.setItem('current', JSON.stringify({ loggedAdmin: admin, isValid: true }));\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    render() {\r\n        const { state, props: { children } } = this;\r\n        return <Context.Provider value={state}>{children}</Context.Provider>;\r\n    }\r\n}\r\n\r\nexport const AdminConsumer = Context.Consumer;"]},"metadata":{},"sourceType":"module"}